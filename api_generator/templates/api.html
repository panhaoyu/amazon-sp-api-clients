"""
{{ data.data.info.title }}
=============================================================================================

{{ data.data.info.description }}
API Version: {{ data.data.info.version }}
Contact Amazon: {{ data.data.info.contact.name }} {% if data.data.info.contact.email %}<{{ data.data.info.contact.email }}> {% endif %}{{ data.data.info.contact.url }}
License for the OpenAPI file: {{ data.data.info.license.name }} {{ data.data.info.license.url }}
"""
import attrs
from ..utils.base_client import BaseClient
from typing import Any, List, Dict, Union, Literal, Optional
from datetime import date, datetime


{% for schema in data.schemas %}
@attrs.define(kw_only=True,frozen=True,slots={% if schema.additionalProperties %}False{% else %}True{% endif %})
class {{ schema.name }}:
    {% if schema.parsed_description %}"""
    {{ schema.parsed_description }}
    """
    {% endif %}

    {% for property in schema.all_properties %}
    {{ property.variable_name }}: {% if property.name in schema.required %}{{ property.type_hint }}{% else %}Optional[{{ property.type_hint }}]{% endif %} = attrs.field()
    {% if property.parsed_description or property.fields %}"""{% if property.parsed_description %}
    {{ property.parsed_description }}{% endif %}{% if property.fields %}

    Extra fields:
    {{ property.fields }}{% endif %}
    """
        {% endif %}
    {% endfor %}

    {% if not schema.properties %}
    pass
    {% endif %}
{% endfor %}

class {{ data.class_name }}Client(BaseClient):
{% for operation in data.operations %}
    def {{ operation.method_name }}(self,
        {% for param in operation.parsed_parameters %}
            {% if param.required %}
            {{ param.variable_name }}: {{ param.type_hint }}{% if not param.required %}=None{% endif %},
            {% endif %}
        {% endfor %}
        {% for param in operation.parsed_parameters %}
            {% if not param.required %}
            {{ param.variable_name }}: {{ param.type_hint }}{% if not param.required %}=None{% endif %},
            {% endif %}
        {% endfor %}
    ) -> {{ operation.result_type }}:
        """
{{ operation.description }}

Args:
    {% for param in operation.parsed_parameters %}{{ param.variable_name }}: {% if param.parsed_description %}{{ param.parsed_description }}{% else %}no description.{% endif %}
    {% endfor %}
"""
        url = "{{ operation.path }}"
        values = ({% for p in operation.parsed_parameters %}{{ p.variable_name }},{% endfor %})
        response = self._parse_args_and_request(url, '{{ operation.method | upper }}', values,
        self._{{ operation.method_name }}_params,
    )
        klass = self._update_verification_status_responses.get(response.status_code)
        # noinspection PyArgumentList
        obj = klass(**response.json())
        return obj
    _{{ operation.method_name }}_params = ( # name, param in
        {% for p in operation.parsed_parameters %}
            ("{{ p.name }}", "{{ p.param_in }}"),{% endfor %}
    )

    _{{ operation.method_name }}_responses = {
    {% for response in operation.parsed_responses %}
        ({{ response.status_code }}, '{{ response.media_type }}'): {{ response.type_hint }},
    {% endfor %}
    }

{% endfor %}